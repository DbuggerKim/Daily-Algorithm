SELECT F.PRODUCT_ID, F.PRODUCT_NAME, (F.PRICE * S.AMOUNT) AS TOTAL_SALES
FROM FOOD_PRODUCT AS F
JOIN (SELECT PRODUCT_ID, SUM(AMOUNT) AS AMOUNT
      FROM (SELECT PRODUCT_ID, AMOUNT
            FROM FOOD_ORDER
            WHERE DATE_FORMAT(PRODUCE_DATE,"%Y/%m")="2022/05") AS FILTER
      GROUP BY PRODUCT_ID) AS S
ON F.PRODUCT_ID=S.PRODUCT_ID
ORDER BY TOTAL_SALES DESC
