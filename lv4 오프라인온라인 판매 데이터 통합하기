
SELECT SUBSTRING(SALES_DATE,1,10) AS SALES_DATE, PRODUCT_ID, USER_ID, sum(SALES_AMOUNT) AS AMOUNT
FROM ONLINE_SALE
WHERE SUBSTRING(SALES_DATE,1,4) = '2022'
  AND SUBSTRING(SALES_DATE,6,2) = '03'
GROUP BY SALES_DATE, PRODUCT_ID, USER_ID

UNION ALL

SELECT SUBSTRING(SALES_DATE,1,10), PRODUCT_ID, NULL, sum(SALES_AMOUNT)
FROM OFFLINE_SALE
WHERE SUBSTRING(SALES_DATE,1,4) = '2022'
  AND SUBSTRING(SALES_DATE,6,2) = '03'
GROUP BY SALES_DATE, PRODUCT_ID
ORDER BY 1,2,3

-- 코드를 입력하세요 OLD
SELECT ONL.SALES_DATE, ONL.PRODUCT_ID, ONL.USER_ID, SUM(ONL.SALES_AMOUNT, OFF.SALES_AMOUNT)
FROM ONLINE_SALE AS ONL
INNER JOIN OFFLINE_SALE AS OFF
ON ONL.PRODUCT_ID=OFF.PRODUCT_ID
WHERE OFF.SALES_DATE LIKE '2022-03%'
ORDER BY ONL.SALES_DATE, ONL.PRODUCT_ID, ONL.USER_ID
